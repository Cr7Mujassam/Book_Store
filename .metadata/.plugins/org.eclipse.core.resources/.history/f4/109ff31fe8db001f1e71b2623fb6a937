<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page contentType="text/html; charset=UTF-8" language="java" %>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Catalog</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

    <div class="container">
        <h2 class="my-5">Book Catalog</h2>
        
        <!-- Container to display books -->
        <div id="bookCatalog" class="row">
            <!-- Books will be dynamically loaded here -->
        </div>
    </div>

    <script>
        $(document).ready(function() {
            // Send an AJAX request to fetch books data
            $.ajax({
                url: 'getBooks',   // URL of the servlet
                type: 'GET',       // Method type (GET, POST, etc.)
                dataType: 'json',  // Expecting JSON response
                success: function(data) {
                    // Handle the successful response (data is the JSON data returned from the servlet)
                    var booksHtml = '';
                    $.each(data, function(index, book) {
                        booksHtml += '<div class="col-md-4 mb-4">';
                        booksHtml += '<div class="card">';
                        booksHtml += '<img src="' + book.coverImage + '" class="card-img-top" alt="' + book.title + '">';
                        booksHtml += '<div class="card-body">';
                        booksHtml += '<h5 class="card-title">' + book.title + '</h5>';
                        booksHtml += '<p class="card-text">' + book.author + '</p>';
                        booksHtml += '<a href="bookDetails.jsp?id=' + book.id + '" class="btn btn-primary">View Details</a>';
                        booksHtml += '</div>';
                        booksHtml += '</div>';
                        booksHtml += '</div>';
                    });

                    // Inject the HTML into the #bookCatalog div
                    $('#bookCatalog').html(booksHtml);
                },
                error: function(xhr, status, error) {
                    // Handle any error that occurs during the AJAX request
                    console.error('Error fetching books:', status, error);
                }
            });
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

